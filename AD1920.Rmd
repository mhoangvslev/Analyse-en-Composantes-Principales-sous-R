---
title: "Analyse en Composantes Principales sous R"
author: "Minh-Hoang DANG"
output:
  pdf_document: default
  html_notebook: default
---

# Introduction

# Les données
Nous avons un jeu de données contenant 1000 gènes de 40 individus. Les 20 premiers individus sont en bonne santé et les autres sont malades. A travers des analyses, nous visons à détecter les gènes qui contribue à la maladie.

```{r}
genes <- read.csv("/media/minhhoangdang/WINDOWS/Users/minhh/OneDrive/UnivN/M1/DataAnalysis/Projet/Docs/Projet M1 AD 1920.csv", header=FALSE)
```

## Résumé des données
```{r}
summary(genes)
```

```{r}
boxplot(t(genes))
```

```{r}
y<-c(2,1,3,4,5,0,7,6,9,2)
Y<-matrix(y,ncol=2,byrow = T) #; Y
ACP<-function(data,reduite=FALSE,nbAxes=2){
    # Procedures 1 et 2
    print("Matrice centree reduite :")
    dCentree<-scale(data,scale=reduite) ; print(dCentree)
    # Procedure 3
    nbIndiv<-nrow(dCentree)
    print("Matrice d'inertie")
    SI<-(1/nbIndiv)*t(dCentree)%*%dCentree ; print(SI)
    # Procedure 4
    eig = eigen(SI)
    valp = eig$values ; vecp = eig$vectors
    print("Axes principaux / vecteurs propres")
    print(valp) ; print(vecp)

    # Procedure 5
    print("Composantes principales")
    F=dCentree%*%vecp
    print(round(F,2))
    print(length(valp))
    print(dim(SI))
    # plot(F)
    
    # Choix du nombre d'axes
    # Calcul des coordonnees des variables
    # G<-matrix(0,nrow(SI),ncol(SI))
    # for(indice in 1:ncol(SI)){
    #     G[,indice]=round(sqrt(valp[indice])%*%vecp[,indice],2)
    # }
    # dim(data)
    # print(G)
    
    
    # Inertie cumulee
    # print(round(valp/sum(valp)*100,2))
    # print(valp) #; print(vecp)
    # print("# Inertie")
    # print(round(cumsum(valp/sum(valp)*100),2))
    # print(length(valp)) ; print(dim(vecp))
}
ACP(Y);
```

